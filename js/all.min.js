"use strict";

$('[data-form]').submit(function(e){
	e.preventDefault();
	var form = $(this).data('form');
	switch(form) {
		case 'downloads':
			var email = $(this).find('input[name="email"]').val();
			$.ajax({
				type: 'POST',
				url: 'ajax.php',
				data: {email: email},
				dataType: 'JSON',
				beforeSend: function(){
					$('.box-message .message').html('');
					$('.box-message .message').removeClass('active');
					$('.box-message').addClass('active');
					$('.box-message .loading').addClass('active');
				},
				success: function(data) {
					setTimeout(function(){
						if(data.status == false) {
							if(data.message == 'email-empty') {
								var message = 'E-mail precisa ser informado!';
							} else if(data.message == 'email-invalid') {
								var message = 'E-mail informado é inválido!';
							} else if(data.message == 'existing') {
								var message = 'E-mail já se encontra cadastrado!';
							} else {
								var message = 'Ocorreu um erro em nosso sistema!';
							}
							$('.box-message .loading').removeClass('active');
							$('.box-message .message').html(message);
							$('.box-message .message').addClass('active');
							setTimeout(function(){
								$('.box-message').removeClass('active');
							}, 4000);
						} else {
							$('.box-message .loading').removeClass('active');
							$('.box-message .message').html('');
							$('.box-message .message').removeClass('active');
							$('.box-message .download').addClass('active');
							$('.btn-baixar').attr('href', data.download);
							$('.btn-baixar').click(function(){
								$('.box-message').removeClass('active');
								$('.box-message .download').removeClass('active');
							});
						}
					}, 2000);
				}
			});
		break;
	}
});